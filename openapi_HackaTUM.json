{"openapi":"3.1.0","info":{"title":"User Management API","description":"A simple REST API for managing users and their preferences using FastAPI and SQLite","version":"1.0.0"},"paths":{"/":{"get":{"tags":["General"],"summary":"Root endpoint","description":"Welcome endpoint for the API","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/users":{"post":{"tags":["Users"],"summary":"Create a new user","description":"Create a new user with their basic information and optional preferences. The user will be assigned a unique ID automatically.","operationId":"create_user_users_post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserCreate"}}}},"responses":{"201":{"description":"User created successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"},"example":{"id":1,"name":"John Doe","age":30,"gender":"Male","location":"Munich","driving_style":"sporty","fuel_preference":"electric","budget_sensitivity":"medium","risk_tolerance":"high","preferences":[{"id":1,"user_id":1,"status":"completed","created_at":"2024-01-01T00:00:00","updated_at":"2024-01-01T00:00:00","questions":[{"id":1,"question_type":"choice","category":"driving_style","question":"What is your preferred driving style?","options":["sporty","relaxed","balanced"],"answer":"sporty","answer_score":4,"importance":5,"frustrated":false}]}]}}}},"400":{"description":"Bad request - Invalid input data"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Users"],"summary":"Get all users","description":"Retrieve a list of all users with pagination support. Returns users with their associated preferences.","operationId":"get_users_users_get","parameters":[{"name":"skip","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Skip"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}}],"responses":{"200":{"description":"List of users retrieved successfully","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UserResponse"},"title":"Response Get Users Users Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/users/{user_id}":{"get":{"tags":["Users"],"summary":"Get user by ID","description":"Retrieve a specific user by their unique ID along with all their preferences.","operationId":"get_user_users__user_id__get","parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"responses":{"200":{"description":"User found and returned successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}},"404":{"description":"User not found","content":{"application/json":{"example":{"detail":"User not found"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/questions":{"post":{"tags":["Questions"],"summary":"Create a new question","description":"Create a new question with question type, category, question text, and optional options.","operationId":"create_question_questions_post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/QuestionCreate"}}}},"responses":{"201":{"description":"Question created successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/QuestionResponse"}}}},"400":{"description":"Bad request - Invalid input data"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Questions"],"summary":"Get all questions","description":"Retrieve a list of all questions with pagination support.","operationId":"get_questions_questions_get","parameters":[{"name":"skip","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Skip"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}},{"name":"category","in":"query","required":false,"schema":{"type":"string","title":"Category"}},{"name":"question_type","in":"query","required":false,"schema":{"type":"string","title":"Question Type"}}],"responses":{"200":{"description":"List of questions retrieved successfully","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/QuestionResponse"},"title":"Response Get Questions Questions Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/questions/{question_id}":{"get":{"tags":["Questions"],"summary":"Get question by ID","description":"Retrieve a specific question by its unique ID.","operationId":"get_question_questions__question_id__get","parameters":[{"name":"question_id","in":"path","required":true,"schema":{"type":"integer","title":"Question Id"}}],"responses":{"200":{"description":"Question found and returned successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/QuestionResponse"}}}},"404":{"description":"Question not found","content":{"application/json":{"example":{"detail":"Question not found"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["Questions"],"summary":"Update a question","description":"Update an existing question by its ID.","operationId":"update_question_questions__question_id__put","parameters":[{"name":"question_id","in":"path","required":true,"schema":{"type":"integer","title":"Question Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/QuestionCreate"}}}},"responses":{"200":{"description":"Question updated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/QuestionResponse"}}}},"404":{"description":"Question not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Questions"],"summary":"Delete a question","description":"Delete a question by its ID. This will also delete all associated preferences.","operationId":"delete_question_questions__question_id__delete","parameters":[{"name":"question_id","in":"path","required":true,"schema":{"type":"integer","title":"Question Id"}}],"responses":{"204":{"description":"Question deleted successfully"},"404":{"description":"Question not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/preferences":{"post":{"tags":["Preferences"],"summary":"Create a new preference","description":"Create a new preference session for a user. Questions will be generated in the background using Celery.","operationId":"create_preference_preferences_post","parameters":[{"name":"user_context","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"User Context"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PreferenceCreate"}}}},"responses":{"201":{"description":"Preference created successfully, questions are being generated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PreferenceCreateResponse"}}}},"404":{"description":"User not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Preferences"],"summary":"Get all preferences","description":"Retrieve a list of all preferences with pagination support.","operationId":"get_preferences_preferences_get","parameters":[{"name":"skip","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Skip"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}},{"name":"user_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"User Id"}},{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Status"}}],"responses":{"200":{"description":"List of preferences retrieved successfully","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/PreferenceResponse"},"title":"Response Get Preferences Preferences Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/preferences/{preference_id}/generate-questions":{"post":{"tags":["Preferences"],"summary":"Trigger question generation","description":"Manually trigger question generation for a preference. This will run in the background.","operationId":"trigger_question_generation_preferences__preference_id__generate_questions_post","parameters":[{"name":"preference_id","in":"path","required":true,"schema":{"type":"integer","title":"Preference Id"}},{"name":"user_context","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"User Context"}}],"responses":{"202":{"description":"Question generation started","content":{"application/json":{"schema":{}}}},"404":{"description":"Preference not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/preferences/{preference_id}":{"get":{"tags":["Preferences"],"summary":"Get preference by ID","description":"Retrieve a specific preference by its unique ID.","operationId":"get_preference_preferences__preference_id__get","parameters":[{"name":"preference_id","in":"path","required":true,"schema":{"type":"integer","title":"Preference Id"}}],"responses":{"200":{"description":"Preference found and returned successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PreferenceResponse"}}}},"404":{"description":"Preference not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Preferences"],"summary":"Delete a preference","description":"Delete a preference by its ID.","operationId":"delete_preference_preferences__preference_id__delete","parameters":[{"name":"preference_id","in":"path","required":true,"schema":{"type":"integer","title":"Preference Id"}}],"responses":{"204":{"description":"Preference deleted successfully"},"404":{"description":"Preference not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/tasks/{task_id}/status":{"get":{"tags":["Tasks"],"summary":"Get task status","description":"Get the status and result of a Celery task.","operationId":"get_task_status_tasks__task_id__status_get","parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"string","title":"Task Id"}}],"responses":{"200":{"description":"Task status retrieved successfully","content":{"application/json":{"schema":{}}}},"404":{"description":"Task not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/questions/{question_id}/answer":{"put":{"tags":["Questions"],"summary":"Update answer to a question","description":"Update the answer for a specific question.","operationId":"update_question_answer_questions__question_id__answer_put","parameters":[{"name":"question_id","in":"path","required":true,"schema":{"type":"integer","title":"Question Id"}},{"name":"answer","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Answer"}},{"name":"answer_score","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Answer Score"}},{"name":"importance","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Importance"}},{"name":"frustrated","in":"query","required":false,"schema":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Frustrated"}}],"responses":{"200":{"description":"Answer updated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/QuestionResponse"}}}},"404":{"description":"Question not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"PreferenceCreate":{"properties":{"user_id":{"type":"integer","title":"User Id","description":"ID of the user","example":1}},"type":"object","required":["user_id"],"title":"PreferenceCreate","example":{"user_id":1}},"PreferenceCreateResponse":{"properties":{"id":{"type":"integer","title":"Id","description":"Unique identifier for the preference"},"user_id":{"type":"integer","title":"User Id","description":"ID of the user who owns this preference"},"status":{"type":"string","title":"Status","description":"Status of the preference"},"created_at":{"type":"string","format":"date-time","title":"Created At","description":"Creation timestamp"},"updated_at":{"type":"string","format":"date-time","title":"Updated At","description":"Last update timestamp"},"task_id":{"type":"string","title":"Task Id","description":"Celery task ID for question generation"},"message":{"type":"string","title":"Message","description":"Status message"}},"type":"object","required":["id","user_id","status","created_at","updated_at","task_id","message"],"title":"PreferenceCreateResponse"},"PreferenceResponse":{"properties":{"id":{"type":"integer","title":"Id","description":"Unique identifier for the preference"},"user_id":{"type":"integer","title":"User Id","description":"ID of the user who owns this preference"},"status":{"type":"string","title":"Status","description":"Status of the preference: pending, generating, completed, failed"},"created_at":{"type":"string","format":"date-time","title":"Created At","description":"Creation timestamp"},"updated_at":{"type":"string","format":"date-time","title":"Updated At","description":"Last update timestamp"},"questions":{"items":{"$ref":"#/components/schemas/QuestionResponse"},"type":"array","title":"Questions","description":"List of questions for this preference","default":[]}},"type":"object","required":["id","user_id","status","created_at","updated_at"],"title":"PreferenceResponse"},"QuestionCreate":{"properties":{"question_type":{"type":"string","title":"Question Type","description":"Type of question - e.g. boolean, text, scale, choice, multi_choice","example":"choice"},"category":{"type":"string","title":"Category","description":"Category of the question - e.g. driving_style, space, technology, fuel, risk, budget","example":"driving_style"},"question":{"type":"string","title":"Question","description":"The question text","example":"What is your preferred driving style?"},"options":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Options","description":"List of available options for choice/multi_choice question types","example":["sporty","relaxed","balanced"]},"answer":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Answer","description":"Default or expected answer for the question","example":"sporty"},"answer_score":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Answer Score","description":"Default or expected score for the answer","example":4},"importance":{"type":"integer","maximum":5.0,"minimum":1.0,"title":"Importance","description":"Default importance level: 1 = low, 5 = critical","default":1,"example":3}},"type":"object","required":["question_type","category","question"],"title":"QuestionCreate","example":{"answer":"sporty","answer_score":4,"category":"driving_style","importance":3,"options":["sporty","relaxed","balanced"],"question":"What is your preferred driving style?","question_type":"choice"}},"QuestionResponse":{"properties":{"id":{"type":"integer","title":"Id","description":"Unique identifier for the question"},"question_type":{"type":"string","title":"Question Type","description":"Type of question"},"category":{"type":"string","title":"Category","description":"Category of the question"},"question":{"type":"string","title":"Question","description":"The question text"},"options":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Options","description":"List of available options"},"answer":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Answer","description":"User's answer to the question"},"answer_score":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Answer Score","description":"Score for the answer"},"importance":{"type":"integer","title":"Importance","description":"Importance level (1-5)"},"frustrated":{"type":"boolean","title":"Frustrated","description":"Whether the user is frustrated","default":false}},"type":"object","required":["id","question_type","category","question","importance"],"title":"QuestionResponse"},"UserCreate":{"properties":{"name":{"type":"string","title":"Name","description":"Full name of the user","example":"John Doe"},"age":{"type":"integer","minimum":0.0,"title":"Age","description":"Age of the user","example":30},"gender":{"type":"string","title":"Gender","description":"Gender of the user","example":"Male"},"location":{"type":"string","title":"Location","description":"Location of the user","example":"Munich"},"driving_style":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Driving Style","description":"Driving style preference - e.g. sporty, relaxed, balanced","example":"sporty"},"fuel_preference":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Fuel Preference","description":"Fuel preference - petrol, hybrid, electric","example":"electric"},"budget_sensitivity":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Budget Sensitivity","description":"Budget sensitivity level - low, medium, high","example":"medium"},"risk_tolerance":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Risk Tolerance","description":"Risk tolerance level - low, medium, high","example":"high"}},"type":"object","required":["name","age","gender","location"],"title":"UserCreate","example":{"age":30,"budget_sensitivity":"medium","driving_style":"sporty","fuel_preference":"electric","gender":"Male","location":"Munich","name":"John Doe","preferences":[{"answer":"sporty","answer_score":4,"frustrated":false,"importance":3,"question_id":1}],"risk_tolerance":"high"}},"UserResponse":{"properties":{"id":{"type":"integer","title":"Id","description":"Unique identifier for the user"},"name":{"type":"string","title":"Name","description":"Full name of the user"},"age":{"type":"integer","title":"Age","description":"Age of the user"},"gender":{"type":"string","title":"Gender","description":"Gender of the user"},"location":{"type":"string","title":"Location","description":"Location of the user"},"driving_style":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Driving Style","description":"Driving style preference"},"fuel_preference":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Fuel Preference","description":"Fuel preference"},"budget_sensitivity":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Budget Sensitivity","description":"Budget sensitivity level"},"risk_tolerance":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Risk Tolerance","description":"Risk tolerance level"},"preferences":{"items":{"$ref":"#/components/schemas/PreferenceResponse"},"type":"array","title":"Preferences","description":"List of user preferences","default":[]}},"type":"object","required":["id","name","age","gender","location"],"title":"UserResponse"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}